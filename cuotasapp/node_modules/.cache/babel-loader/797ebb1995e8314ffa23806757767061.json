{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\juanm\\\\Documents\\\\Proyecto_web\\\\ProyectoFinal-IAW\\\\cuotasapp\\\\src\\\\Elements\\\\PaymentForm.jsx\";\nimport React from 'react';\nimport { useEffect } from 'react';\nimport swal from 'sweetalert';\nimport { Button } from '@material-ui/core';\nimport Axios from 'axios';\nimport { useHistory } from 'react-router-dom';\nimport { BackButton } from './BackButton';\nexport const PaymentForm = props => {\n  const history = useHistory();\n  const id = props.location.pathname.split(\"/\")[3];\n  useEffect(() => {\n    window.Mercadopago.setPublishableKey(\"TEST-bc17f6a0-f7b6-44e0-9e73-8bfd9973b243\");\n    window.Mercadopago.getIdentificationTypes();\n  });\n\n  const guessPaymentMethod = () => {\n    let cardnumber = document.getElementById(\"cardNumber\").value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n      window.Mercadopago.getPaymentMethod({\n        \"bin\": bin\n      }, setPaymentMethod);\n    }\n  };\n\n  const setPaymentMethod = (status, response) => {\n    if (status === 200) {\n      let paymentMethodId = response[0].id;\n      let element = document.getElementById('payment_method_id');\n      element.value = paymentMethodId;\n      getInstallments();\n    } else {\n      document.getElementById(\"cardNumber\").value = \"\";\n      swal(\"Número de tarjeta incorrecto!\", \"\", \"error\");\n    }\n  };\n\n  const getInstallments = () => {\n    window.Mercadopago.getInstallments({\n      \"payment_method_id\": document.getElementById('payment_method_id').value,\n      \"amount\": parseFloat(document.getElementById('transaction_amount').value)\n    }, function (status, response) {\n      if (status === 200) {\n        document.getElementById('installments').options.length = 0;\n        response[0].payer_costs.forEach(installment => {\n          let opt = document.createElement('option');\n          opt.text = installment.recommended_message;\n          opt.value = installment.installments;\n          document.getElementById('installments').appendChild(opt);\n        });\n      } else {\n        alert(`installments method info error: ${response}`);\n      }\n    });\n  };\n\n  const doPay = () => {\n    Mercadopago.clearSession();\n    var data = {\n      cardNumber: document.getElementById(\"cardNumber\").value,\n      securityCode: document.getElementById(\"securityCode\").value,\n      cardExpirationMonth: document.getElementById(\"cardExpirationMonth\").value,\n      cardExpirationYear: document.getElementById(\"cardExpirationYear\").value,\n      cardholderName: document.getElementById(\"cardholderName\").value,\n      docType: document.getElementById(\"docType\").value,\n      docNumber: document.getElementById(\"docNumber\").value,\n      installments: document.getElementById(\"installments\").value\n    };\n    window.Mercadopago.createToken(data, sdkResponseHandler);\n    return false;\n  };\n\n  const sdkResponseHandler = (status, response) => {\n    console.log(response);\n\n    if (status !== 200 && status !== 201) {\n      swal(\"Revise la información!\", \"\", \"error\");\n    } else {\n      var data = {\n        transaction_amount: document.getElementById(\"transaction_amount\").value,\n        token: response.id,\n        description: document.getElementById(\"description\").value,\n        installments: document.getElementById(\"installments\").value,\n        payment_method_id: document.getElementById(\"payment_method_id\").value,\n        email: document.getElementById(\"email\").value\n      };\n      Axios.post(\"http://localhost:5001/customers/\" + id + '/card', data, {\n        \"headers\": {\n          \"token\": sessionStorage.getItem(\"token\")\n        }\n      }).then(res => {\n        console.log(res);\n        swal(\"Pago procesado!\", \"\", \"success\").then(() => {\n          history.push(\"/admin/customer/\" + id);\n        });\n      }).catch(err => swal(\"El pago no ha podido ser procesado\", \"\", \"error\"));\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(BackButton, {\n    link: \"/admin/customer/\" + id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"description\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 21\n    }\n  }, \"Descripci\\xF3n\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"description\",\n    id: \"description\",\n    defaultValue: \"\\xCDtem seleccionado\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"transaction_amount\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }\n  }, \"Monto a pagar\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"transaction_amount\",\n    id: \"transaction_amount\",\n    defaultValue: \"100\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"cardNumber\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, \"N\\xFAmero de la tarjeta\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: guessPaymentMethod,\n    type: \"text\",\n    id: \"cardNumber\",\n    \"data-checkout\": \"cardNumber\",\n    autoComplete: \"off\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"cardholderName\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }\n  }, \"Nombre y apellido\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"cardholderName\",\n    \"data-checkout\": \"cardholderName\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"cardExpirationMonth\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }, \"Mes de vencimiento\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"cardExpirationMonth\",\n    \"data-checkout\": \"cardExpirationMonth\",\n    autoComplete: \"off\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"cardExpirationYear\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }\n  }, \"A\\xF1o de vencimiento\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"cardExpirationYear\",\n    \"data-checkout\": \"cardExpirationYear\",\n    autoComplete: \"off\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"securityCode\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, \"C\\xF3digo de seguridad\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"securityCode\",\n    \"data-checkout\": \"securityCode\",\n    autoComplete: \"off\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"installments\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, \"Cuotas\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    id: \"installments\",\n    name: \"installments\",\n    className: \"form-control w-75\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"docType\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 21\n    }\n  }, \"Tipo de documento\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    id: \"docType\",\n    \"data-checkout\": \"docType\",\n    className: \"form-control w-75\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"docNumber\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }, \"N\\xFAmero de documento\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    id: \"docNumber\",\n    \"data-checkout\": \"docNumber\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"email\",\n    className: \"col-sm-2 col-form-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 21\n    }\n  }, \"E-mail\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-sm-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    name: \"email\",\n    defaultValue: \"test@test.com\",\n    className: \"form-control w-75 p-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 25\n    }\n  }))), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"hidden\",\n    name: \"payment_method_id\",\n    id: \"payment_method_id\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: doPay,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \"Pagar\")));\n};","map":{"version":3,"sources":["C:/Users/juanm/Documents/Proyecto_web/ProyectoFinal-IAW/cuotasapp/src/Elements/PaymentForm.jsx"],"names":["React","useEffect","swal","Button","Axios","useHistory","BackButton","PaymentForm","props","history","id","location","pathname","split","window","Mercadopago","setPublishableKey","getIdentificationTypes","guessPaymentMethod","cardnumber","document","getElementById","value","length","bin","substring","getPaymentMethod","setPaymentMethod","status","response","paymentMethodId","element","getInstallments","parseFloat","options","payer_costs","forEach","installment","opt","createElement","text","recommended_message","installments","appendChild","alert","doPay","clearSession","data","cardNumber","securityCode","cardExpirationMonth","cardExpirationYear","cardholderName","docType","docNumber","createToken","sdkResponseHandler","console","log","transaction_amount","token","description","payment_method_id","email","post","sessionStorage","getItem","then","res","push","catch","err"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { useEffect } from 'react'\r\nimport swal from 'sweetalert';\r\nimport { Button } from '@material-ui/core';\r\nimport Axios from 'axios';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { BackButton } from './BackButton';\r\n\r\nexport const PaymentForm = (props) => {\r\n    const history = useHistory();\r\n    const id = props.location.pathname.split(\"/\")[3];\r\n\r\n    useEffect(() => {\r\n        window.Mercadopago.setPublishableKey(\"TEST-bc17f6a0-f7b6-44e0-9e73-8bfd9973b243\");\r\n        window.Mercadopago.getIdentificationTypes();\r\n    })\r\n\r\n    const guessPaymentMethod = () => {\r\n        let cardnumber = document.getElementById(\"cardNumber\").value;\r\n\r\n        if (cardnumber.length >= 6) {\r\n            let bin = cardnumber.substring(0,6);\r\n            window.Mercadopago.getPaymentMethod({\r\n                \"bin\": bin\r\n            }, setPaymentMethod);\r\n        }\r\n    }\r\n\r\n    const setPaymentMethod = (status, response) => {\r\n        if (status === 200) {\r\n            let paymentMethodId = response[0].id;\r\n            let element = document.getElementById('payment_method_id');\r\n            element.value = paymentMethodId;\r\n            getInstallments();\r\n        } else {\r\n            document.getElementById(\"cardNumber\").value = \"\";\r\n            swal(\"Número de tarjeta incorrecto!\", \"\", \"error\")\r\n        }\r\n    }\r\n\r\n    const getInstallments = () => {\r\n        window.Mercadopago.getInstallments({\r\n            \"payment_method_id\": document.getElementById('payment_method_id').value,\r\n            \"amount\": parseFloat(document.getElementById('transaction_amount').value)\r\n            \r\n        }, function (status, response) {\r\n            if (status === 200) {\r\n                document.getElementById('installments').options.length = 0;\r\n                response[0].payer_costs.forEach( installment => {\r\n                    let opt = document.createElement('option');\r\n                    opt.text = installment.recommended_message;\r\n                    opt.value = installment.installments;\r\n                    document.getElementById('installments').appendChild(opt);\r\n                });\r\n            } else {\r\n                alert(`installments method info error: ${response}`);\r\n            }\r\n        });\r\n    }\r\n\r\n    const doPay = () => {\r\n        Mercadopago.clearSession();\r\n        var data = {\r\n            cardNumber: document.getElementById(\"cardNumber\").value,\r\n            securityCode: document.getElementById(\"securityCode\").value,\r\n            cardExpirationMonth: document.getElementById(\"cardExpirationMonth\").value,\r\n            cardExpirationYear: document.getElementById(\"cardExpirationYear\").value,\r\n            cardholderName: document.getElementById(\"cardholderName\").value,\r\n            docType: document.getElementById(\"docType\").value,\r\n            docNumber: document.getElementById(\"docNumber\").value,\r\n            installments: document.getElementById(\"installments\").value\r\n        }\r\n        \r\n        window.Mercadopago.createToken(data, sdkResponseHandler);\r\n\r\n        return false;\r\n    }\r\n\r\n    const sdkResponseHandler = (status, response) => {\r\n        console.log(response)\r\n        if (status !== 200 && status !== 201) {\r\n            swal(\"Revise la información!\", \"\", \"error\")\r\n        }else{\r\n            var data = {\r\n                transaction_amount: document.getElementById(\"transaction_amount\").value,\r\n                token: response.id,\r\n                description: document.getElementById(\"description\").value,\r\n                installments: document.getElementById(\"installments\").value,\r\n                payment_method_id: document.getElementById(\"payment_method_id\").value,\r\n                email: document.getElementById(\"email\").value\r\n            }\r\n\r\n            Axios.post(\"http://localhost:5001/customers/\"+id+'/card', data, {\"headers\": {\"token\": sessionStorage.getItem(\"token\")}})\r\n                .then(res => {\r\n                    console.log(res);\r\n                    swal(\"Pago procesado!\", \"\", \"success\")\r\n                        .then(() => {history.push(\"/admin/customer/\"+id)})\r\n                })\r\n                .catch(err => swal(\"El pago no ha podido ser procesado\", \"\", \"error\"));\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                <BackButton link={\"/admin/customer/\"+id} />\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"description\" className=\"col-sm-2 col-form-label\">Descripción</label>                  \r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" name=\"description\" id=\"description\" defaultValue=\"Ítem seleccionado\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>                    \r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"transaction_amount\" className=\"col-sm-2 col-form-label\">Monto a pagar</label>     \r\n                    <div className=\"col-sm-10\">                   \r\n                        <input name=\"transaction_amount\" id=\"transaction_amount\" defaultValue=\"100\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"cardNumber\" className=\"col-sm-2 col-form-label\">Número de la tarjeta</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input onChange={guessPaymentMethod} type=\"text\" id=\"cardNumber\" data-checkout=\"cardNumber\" autoComplete=\"off\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"cardholderName\" className=\"col-sm-2 col-form-label\">Nombre y apellido</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" id=\"cardholderName\" data-checkout=\"cardholderName\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>                                    \r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"cardExpirationMonth\" className=\"col-sm-2 col-form-label\">Mes de vencimiento</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" id=\"cardExpirationMonth\" data-checkout=\"cardExpirationMonth\" autoComplete=\"off\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"cardExpirationYear\" className=\"col-sm-2 col-form-label\">Año de vencimiento</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" id=\"cardExpirationYear\" data-checkout=\"cardExpirationYear\" autoComplete=\"off\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"securityCode\" className=\"col-sm-2 col-form-label\">Código de seguridad</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" id=\"securityCode\" data-checkout=\"securityCode\" autoComplete=\"off\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"installments\" className=\"col-sm-2 col-form-label\">Cuotas</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <select id=\"installments\" name=\"installments\" className=\"form-control w-75\"></select>\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"docType\" className=\"col-sm-2 col-form-label\">Tipo de documento</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <select id=\"docType\" data-checkout=\"docType\" className=\"form-control w-75\"></select>\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"docNumber\" className=\"col-sm-2 col-form-label\">Número de documento</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"text\" id=\"docNumber\" data-checkout=\"docNumber\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"email\" className=\"col-sm-2 col-form-label\">E-mail</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input type=\"email\" id=\"email\" name=\"email\" defaultValue=\"test@test.com\" className=\"form-control w-75 p-3\" />\r\n                    </div>\r\n                </div>  \r\n                \r\n                <input type=\"hidden\" name=\"payment_method_id\" id=\"payment_method_id\"/>\r\n                    \r\n                <Button variant=\"contained\" color=\"primary\" onClick={doPay}>Pagar</Button>\r\n            </div>\r\n        </>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}